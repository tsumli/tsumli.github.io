<!doctype html><html lang=ja><head><title>Optimal Transport 03. Unbalanced Optimal Transport | tsumli-pages</title><meta charset=utf-8><meta name=language content="en"><meta name=description content><meta name=keywords content="optimal-transport ,unbalanced-optimal-transport ,最適輸送理論 ,最適輸送問題"><meta name=viewport content="width=device-width,initial-scale=1"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><link rel="shortcut icon" type=image/png href=https://tsumli.github.io/favicon.ico><link type=text/css rel=stylesheet href=https://tsumli.github.io/css/post.min.b60e0932fe1c50c3d7c5b4f83ee9e4592363654d0f2abf05bbd0678d5b8a214c.css integrity="sha256-tg4JMv4cUMPXxbT4PunkWSNjZU0PKr8Fu9BnjVuKIUw="><link type=text/css rel=stylesheet href=https://tsumli.github.io/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css integrity="sha256-47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU="><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/tsumli.github.io\/"},"articleSection":"blog","name":"Optimal Transport 03. Unbalanced Optimal Transport","headline":"Optimal Transport 03. Unbalanced Optimal Transport","description":"","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"2021","datePublished":"2021-03-11 13:55:54 \u002b0000 UTC","dateModified":"2021-03-11 13:55:54 \u002b0000 UTC","url":"https:\/\/tsumli.github.io\/blog\/optimal-transport\/03-unbalanced\/","wordCount":"814","keywords":["optimal-transport","unbalanced-optimal-transport","最適輸送理論","最適輸送問題","Blog"]}</script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-188554402-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><div class=burger__container><div class=burger aria-controls=navigation aria-label=Menu><div class="burger__meat burger__meat--1"></div><div class="burger__meat burger__meat--2"></div><div class="burger__meat burger__meat--3"></div></div></div><nav class=nav id=navigation><ul class=nav__list><li><a href=https://tsumli.github.io/>about</a></li><li><a class=active href=https://tsumli.github.io/blog>blog</a></li></ul></nav><main><div class=flex-wrapper><div class=post__container><div class=post><header class=post__header><h1 id=post__title>Optimal Transport 03. Unbalanced Optimal Transport</h1><time datetime="2021-03-11 13:55:54 +0000 UTC" class=post__date>Mar 11 2021</time></header><article class=post__content><p><a href=https://tsumli.github.io/blog/optimal-transport/01-introduction/>01. はじめ</a><br><a href=https://tsumli.github.io/blog/optimal-transport/02-entropy/>02. エントロピー正則化</a><br><a href=https://tsumli.github.io/blog/optimal-transport/03-unbalanced/>03. Unbalanced Optimal Transport</a><br>Optimal Transportの拡張系である<strong>Unbalanced Optimal Transport</strong>について紹介します．</p><h2 id=unbalanced-optimal-transport-unbalanced-ot>Unbalanced Optimal Transport (Unbalanced OT)<a class=anchor href=#unbalanced-optimal-transport-unbalanced-ot>#</a></h2><p>まず，式を見ていきましょう．
$$
L_\mathbf{C}^\tau (\mathbf{a}, \mathbf{b}) = \min_{\mathbf{P}\in\mathbb{R}_+^{n\times m}} \langle \mathbf{C}, \mathbf{P} \rangle
+\tau_1\mathbf{D}_\varphi(\mathbf{P}\mathbb{1}_m|\mathbf{a}) +
\tau_2\mathbf{D}_\varphi(\mathbf{P}^\mathsf{T}\mathbb{1}_n|\mathbf{b})
$$
第1項は通常のoptimal transportでの最小化目標です．そして，この第2, 3項が追加されたものとなります．$\mathbf{D}_\varphi(\cdot|\cdot)$ はズレを表す関数で，例えば，euclideanだったりKL距離だったりが考えられます．そして，$\tau_1, \tau_2$はそれらのズレに対するペナルティの大きさを表しています．つまり，$\tau_1 = \tau_2 \rightarrow +\infty$のときズレを許さない，つまり，&ldquo;balanced"な (通常の) optimal transportとなります．また，$\mathbf{D}_\varphi = \mathbf{KL}$ で，$\tau_1 = \tau_2 \rightarrow 0$ のとき，Hellinger距離と呼ばれる距離となります．
$$
\mathrm{L}(\mathbf{a}, \mathbf{b}) = \sum_i(\sqrt{\mathbf{a}_i} - \sqrt{\mathbf{b}_i})^2
$$</p><p>Unbalanced OTの計算にもSinkhorn&rsquo;s iterationを使うことができます．updateは次の式を順番に行うことで行われます，
$$
\mathbf{u} \leftarrow \Bigl( \frac{\mathbf{a}}{\mathbf{Kv}}\Bigr)^{\tau_1/(\tau_1 + \varepsilon)} \quad \mathrm{and} \quad \mathbf{v} \leftarrow \Bigl(\frac{\mathbf{b}}{\mathbf{K}^\mathsf{T}\mathbf{v}}\Bigr)^{\tau_2/(\tau_2 + \varepsilon)}<br>$$</p><p>Unbalanced OTのイメージは次のようになります．<figure><img src=images/unbalancedOT.png></figure>左図がClassical OT (通常のoptimal trasnport)
右図がUnbalanced OTを表しています．
Classical OTのとき．左側の山が２つに分散し，右側の山と合流して輸送が行われています．
それに対して，Unbalanced OTでは左側の山は左側に，右側の山は右側に移動しています．
つまり，Unnbalanced OTは，より"柔軟な"輸送がなされているといえます．</p><p>実際の応用としては，input dataがノイジーだったり完全に分かっていないときに，classical OTよりunbalanced OTのほうが優れていることが多いようです．</p><h2 id=参考文献>参考文献<a class=anchor href=#参考文献>#</a></h2><ul><li><a href=https://arxiv.org/abs/1803.00567 target=_blank rel="noreferrer noopener">Computational optimal transport</a></li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script><script type=text/x-mathjax-config>
    MathJax.Hub.Config({
            showMathMenu: false, //disables context menu
            tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ]
           }
    });
</script></article><ul class=tags__list><li class=tag__item><a class=tag__link href=https://tsumli.github.io/tags/optimal-transport/>optimal-transport</a></li></ul><div class=pagination><a class=pagination__item href=https://tsumli.github.io/blog/optimal-transport/02-entropy/><span class=pagination__label>Previous Post</span>
<span class=pagination__title>Optimal Transport 02. エントロピー正則化</span></a>
<a class=pagination__item href=https://tsumli.github.io/blog/abci/docker-build-singularity/><span class=pagination__label>Next Post</span>
<span class=pagination__title>DockerでSingularityのImageをbuildする</span></a></div><footer class=post__footer><div class=social-icons><a class=social-icons__link rel=me title=GitHub href=https://github.com/tsumli target=_blank rel=noopener><div class=social-icons__icon style=background-image:url(https://tsumli.github.io/svg/github.svg)></div></a><a class=social-icons__link rel=me title=Medium href=https://medium.com/@tsumli target=_blank rel=noopener><div class=social-icons__icon style=background-image:url(https://tsumli.github.io/svg/medium.svg)></div></a></div><p>© 2021</p></footer></div></div><div class=toc-container><div class=toc-post-title>Optimal Transport 03. Unbalanced Optimal Transport</div><nav id=TableOfContents><ul><li><a href=#unbalanced-optimal-transport-unbalanced-ot>Unbalanced Optimal Transport (Unbalanced OT)</a></li><li><a href=#参考文献>参考文献</a></li></ul></nav></div></div></main><script src=https://tsumli.github.io/js/index.min.49e4d8a384357d9b445b87371863419937ede9fa77737522ffb633073aebfa44.js integrity="sha256-SeTYo4Q1fZtEW4c3GGNBmTft6fp3c3Ui/7YzBzrr+kQ=" crossorigin=anonymous></script><script src=https://unpkg.com/prismjs@1.20.0/components/prism-core.min.js></script><script src=https://unpkg.com/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js data-autoloader-path=https://unpkg.com/prismjs@1.20.0/components/></script><script src=https://tsumli.github.io/js/table-of-contents.js></script></body></html>