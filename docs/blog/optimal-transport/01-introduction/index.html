<!doctype html><html lang=ja>
<head>
<title>Optimal Transport 01. はじめ | tsumli-pages</title>
<meta charset=utf-8>
<meta name=language content="en">
<meta name=description content>
<meta name=keywords content="optimal-transport ,最適輸送理論 ,最適輸送問題">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<link rel="shortcut icon" type=image/png href=https://tsumli.github.io/favicon.ico>
<link type=text/css rel=stylesheet href=https://tsumli.github.io/css/post.min.86d1effd4c412b85ac13db53a90c473a0f256f789b821e131125c9aa25cb6a6d.css integrity="sha256-htHv/UxBK4WsE9tTqQxHOg8lb3ibgh4TESXJqiXLam0=">
<link type=text/css rel=stylesheet href=https://tsumli.github.io/css/custom.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css integrity="sha256-47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU=">
<script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/tsumli.github.io\/"},"articleSection":"blog","name":"Optimal Transport 01. はじめ","headline":"Optimal Transport 01. はじめ","description":"","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"2021","datePublished":"2021-02-02 13:55:54 \u002b0000 UTC","dateModified":"2021-02-02 13:55:54 \u002b0000 UTC","url":"https:\/\/tsumli.github.io\/blog\/optimal-transport\/01-introduction\/","wordCount":"1051","keywords":["optimal-transport","最適輸送理論","最適輸送問題","Blog"]}</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-188554402-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</head>
<body>
<div class=burger__container>
<div class=burger aria-controls=navigation aria-label=Menu>
<div class="burger__meat burger__meat--1"></div>
<div class="burger__meat burger__meat--2"></div>
<div class="burger__meat burger__meat--3"></div>
</div>
</div>
<nav class=nav id=navigation>
<ul class=nav__list>
<li>
<a href=https://tsumli.github.io/>about</a>
</li>
<li>
<a class=active href=https://tsumli.github.io/blog>blog</a>
</li>
</ul>
</nav>
<main>
<div class=flex-wrapper>
<div class=post__container>
<div class=post>
<header class=post__header>
<h1 id=post__title>Optimal Transport 01. はじめ</h1>
<time datetime="2021-02-02 13:55:54 +0000 UTC" class=post__date>Feb 2 2021</time>
<link rel=stylesheet href=https://tsumli.github.io//css/lightbox.min.css>
<script type=text/javascript>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],processEscapes:!0,tags:"ams",autoload:{color:[],colorV2:['color']},packages:{'[+]':['noerrors']}},chtml:{matchFontHeight:!1,displayAlign:"left",displayIndent:"2em"},options:{skipHtmlTags:['script','noscript','style','textarea','pre'],renderActions:{find_script_mathtex:[10,function(a){for(const b of document.querySelectorAll('script[type^="math/tex"]')){const e=!!b.type.match(/; *mode=display/),c=new a.options.MathItem(b.textContent,a.inputJax[0],e),d=document.createTextNode('');b.parentNode.replaceChild(d,b),c.start={node:d,delim:'',n:0},c.end={node:d,delim:'',n:0},a.math.push(c)}},'']}},loader:{load:['[tex]/noerrors']}}</script>
<script type=text/javascript async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js id=MathJax-script></script>
<link rel=stylesheet type=text/css href=https://tsumli.github.io/css/mathjax-style.css>
</header>
<article class=post__content>
<p><a href=https://tsumli.github.io/blog/optimal-transport/01-introduction/>01. はじめ</a>
<br>
<a href=https://tsumli.github.io/blog/optimal-transport/02-entropy/>02. エントロピー正則化</a>
<br>
<a href=https://tsumli.github.io/blog/optimal-transport/03-unbalanced/>03. Unbalanced Optimal Transport</a>
</p>
<h2 id=optimal-transport-とは>Optimal Transport とは<a class=anchor href=#optimal-transport-とは>#</a></h2>
<p><strong>Optimal Transport</strong>は、日本語で<strong>最適輸送</strong> (問題) と訳されます。
和訳が表しているように、ある物体をある地点から別の地点に移したときの最小コスト、そしてその輸送方法を求めるという問題です。そこから、確率分布の比較に使われるようになりました。</p>
<h2 id=歴史>歴史<a class=anchor href=#歴史>#</a></h2>
<p>歴史は古く、1781年にGaspard Mongeが提案しました<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>。問題の発想は簡単で、
<strong>ある場所から別の場所に土砂を運ぶとき、どのように運べばよいのか</strong>
というものです。<br>
もっと具体的に考えてみましょう。ある場所 (場所Aとします) には $n$ 地点に土砂があったとします。そして、移動先の場所 (場所Bとします) の $n$ 地点に土砂を移したいとします。
Aの $i$ 地点とBの $j$ 地点の間の距離=コストが $\mathbf C_{i,j}$ と表されるとき、
平均の輸送コストはどのようになるか。という問題です。<br>
これを数式で表すと次のようになります。
$$
\min_{\sigma \in \mathrm{Perm}(n)} \frac{1}{n} \sum_{i=1}^{n} \mathbf{C}_{i, \sigma(i)}
$$
ここで、$\mathrm{Perm}(n)$は$n$の順列の集合。<br>
では、これを貪欲に解こうと思うと、$O(n!)$ 回計算しなければなりません ($n\geq 10$ だとつらいというイメージ) 。
そこで、この問題をもとに現在に至るまで様々なアルゴリズムが開発されてきました。</p>
<h2 id=kantorovichの一般化>Kantorovichの一般化<a class=anchor href=#kantorovichの一般化>#</a></h2>
<p>Kantorovichはこの輸送問題を確率分布間に適用しました。
距離を求めたい確率分布を $\mathbf{a}\in \mathbb{R}^n, \mathbf{b}\in \mathbb{R}^m$ とします。
ここで、$\mathbf{a}$ と $\mathbf{b}$ の同時分布 $\mathbf{U}$ を考えます。
$$
\mathbf{U}(\mathbf{a}, \mathbf{b}) \triangleq \lbrace \mathbf{P}\in\mathbb{R}^{n\times m}_+: \mathbf{P}\mathbf{1}_m = \mathbf{a} \mathrm{\ and\ } \mathbf{P}^\mathsf{T}\mathbf{1}_n = \mathbf{b} \rbrace
$$
このとき、$\mathbf{1}_n$ は $1$ が $n$ 個並んだベクトル。また、$\mathbf{P}$ を輸送計画行列と呼び、$(i, j)$ 要素は $i$ 地点から $j$ 地点まで移動させる量を表します。<br>
この集合の制約条件 ( $\mathbf{P}\mathbf{1}_m = \mathbf{a}$ ) について考えます。
$\mathbf{P}\mathbf{1}_m$ は、行列 $\mathbf{P}$ に対しdim=0でsumを取ったときと同等の結果になります (shapeが違うという意味です) 。
つまり、$\mathbf{P}$ の $i$ 行の要素の合計が $\mathbf{a}_i$ と一致するということです。
同様に、$\mathbf{P}^\mathsf{T} \mathbf{1}_n = \mathbf{b}$ とは、$\mathbf{P}$ の $j$ 列の要素の合計が $\mathbf{b}_j$ と一致するという意味です。</p>
<p>すると、輸送問題はこの制約付きの同時分布を考えた上での、次のような最小化問題になります。
$$
\mathrm{L_{\mathbf{C}}} (\mathbf{a}, \mathbf{b})\triangleq \min_{\mathbf{P}\in\mathbf{U}(\mathbf{a}, \mathbf{b})} \langle \mathbf{C}, \mathbf{P} \rangle \triangleq \min \sum_{i, j} \mathbf{C}_{i,j} \mathbf{P}_{i, j}
$$
ここで、$\langle \cdot, \cdot \rangle$はフロベニウス積。</p>
<p><a href=https://tsumli.github.io/blog/optimal-transport/02-entropy/>つづく</a>
</p>
<h2 id=参考文献>参考文献<a class=anchor href=#参考文献>#</a></h2>
<ul>
<li><a href=https://arxiv.org/abs/1803.00567 target=_blank rel="noreferrer noopener">Computational optimal transport</a>
</li>
</ul>
<section class=footnotes role=doc-endnotes>
<hr>
<ol>
<li id=fn:1 role=doc-endnote>
<p>Gaspard Monge. Mémoire sur la théorie des déblais et des remblais. De l’Imprimerie Royale, 1781.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
</ol>
</section>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_SVG"></script>
<script type=text/x-mathjax-config>
    MathJax.Hub.Config({
            showMathMenu: false, //disables context menu
            tex2jax: {
            inlineMath: [ ['$','$'], ['\\(','\\)'] ]
           }
    });
</script>
</article>
<ul class=tags__list>
<li class=tag__item>
<a class=tag__link href=https://tsumli.github.io/tags/optimal-transport/>optimal-transport</a>
</li></ul>
<div class=pagination>
<a class=pagination__item href=https://tsumli.github.io/blog/abci/singularity/>
<span class=pagination__label>Previous Post</span>
<span class=pagination__title>自分的Singularityの使い方</span>
</a>
<a class=pagination__item href=https://tsumli.github.io/blog/optimal-transport/02-entropy/>
<span class=pagination__label>Next Post</span>
<span class=pagination__title>Optimal Transport 02. エントロピー正則化</span>
</a>
</div>
<footer class=post__footer>
<div class=social-icons>
<a class=social-icons__link rel=me title=Kaggle href=https://www.kaggle.com/tsumli target=_blank rel=noopener>
<div class=social-icons__icon style=background-image:url(https://tsumli.github.io/svg/kaggle.svg)></div>
</a>
<a class=social-icons__link rel=me title=GitHub href=https://github.com/tsumli target=_blank rel=noopener>
<div class=social-icons__icon style=background-image:url(https://tsumli.github.io/svg/github.svg)></div>
</a>
<a class=social-icons__link rel=me title=Medium href=https://medium.com/@tsumli target=_blank rel=noopener>
<div class=social-icons__icon style=background-image:url(https://tsumli.github.io/svg/medium.svg)></div>
</a>
</div>
<p>© 2023</p>
<script src=https://code.jquery.com/jquery-3.4.1.min.js integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin=anonymous></script>
<link rel=stylesheet href=https://tsumli.github.io//css/lightbox.min.css>
<script src=https://tsumli.github.io//js/lightbox.min.js></script>
</footer>
</div>
</div>
<div class=toc-container>
<div class=toc-post-title>Optimal Transport 01. はじめ</div>
<nav id=TableOfContents>
<ul>
<li><a href=#optimal-transport-とは>Optimal Transport とは</a></li>
<li><a href=#歴史>歴史</a></li>
<li><a href=#kantorovichの一般化>Kantorovichの一般化</a></li>
<li><a href=#参考文献>参考文献</a></li>
</ul>
</nav>
</div>
</div>
</main>
<script src=https://tsumli.github.io/js/index.min.575dda8d49ee02639942c63564273e6da972ab531dda26a08800bdcb477cbd7f.js integrity="sha256-V13ajUnuAmOZQsY1ZCc+balyq1Md2iagiAC9y0d8vX8=" crossorigin=anonymous></script>
<script src=https://unpkg.com/prismjs@1.20.0/components/prism-core.min.js></script>
<script src=https://unpkg.com/prismjs@1.20.0/plugins/autoloader/prism-autoloader.min.js data-autoloader-path=https://unpkg.com/prismjs@1.20.0/components/></script>
<script src=https://tsumli.github.io/js/table-of-contents.js></script>
</body>
</html>